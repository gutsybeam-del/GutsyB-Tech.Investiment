<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Great Achiever International College | Official Portal</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://checkout.flutterwave.com/v3.js"></script>
    
    <style>
        :root { --primary: #800000; --secondary: #000033; --accent: #daa520; --bg: #f8fafc; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); margin: 0; color: #334155; }
        
        /* Professional School Header */
        header { background: linear-gradient(to right, var(--primary), var(--secondary)); color: white; padding: 40px 20px; text-align: center; border-bottom: 6px solid var(--accent); }
        .school-name { font-size: 32px; font-weight: 900; text-transform: uppercase; margin: 0; }
        .motto { font-style: italic; color: var(--accent); margin-top: 5px; }

        /* Navigation */
        nav { background: #fff; padding: 0; display: flex; justify-content: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1); sticky: top; }
        nav a { padding: 15px 25px; color: var(--secondary); text-decoration: none; font-weight: 700; cursor: pointer; transition: 0.3s; }
        nav a:hover { background: var(--primary); color: white; }

        /* Main Container */
        .container { max-width: 1200px; margin: 40px auto; padding: 0 20px; }
        .card { background: white; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); padding: 30px; margin-bottom: 30px; border-left: 8px solid var(--primary); }
        .screen { display: none; }
        .active { display: block; animation: slideUp 0.5s ease; }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        /* Inputs & Buttons */
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
        input, select { width: 100%; padding: 14px; border: 1px solid #e2e8f0; border-radius: 6px; font-size: 15px; box-sizing: border-box; }
        .btn { background: var(--primary); color: white; border: none; padding: 15px 30px; border-radius: 6px; font-weight: 700; cursor: pointer; width: 100%; font-size: 16px; margin-top: 10px; }
        .btn-pay { background: var(--accent); color: black; }
        .btn-admin { background: var(--secondary); }

        /* Student Record Table */
        .table-wrap { overflow-x: auto; margin-top: 20px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { text-align: left; padding: 15px; border-bottom: 1px solid #e2e8f0; font-size: 14px; }
        th { background: #f1f5f9; color: var(--primary); font-weight: 800; }
        
        .badge { padding: 5px 10px; border-radius: 4px; font-size: 11px; font-weight: bold; }
        .paid { background: #dcfce7; color: #166534; }
        .unpaid { background: #fee2e2; color: #991b1b; }
    </style>
</head>
<body>

<header>
    <h1 class="school-name">Great Achiever International College</h1>
    <div class="motto">Knowledge â€¢ Excellence â€¢ Integrity</div>
</header>

<nav>
    <a onclick="showScreen('student-login')">STUDENT LOGIN</a>
    <a onclick="showScreen('admin-login')">STAFF PORTAL</a>
</nav>

<div class="container">

    <div id="student-login" class="screen active card">
        <h2 style="color:var(--primary)">Student Portal Access</h2>
        <p>Enter your unique Admission/Matric Number to view results and pay fees.</p>
        <input type="text" id="login-id" placeholder="Admission Number (e.g. GAIC/2025/101)">
        <button class="btn" onclick="handleStudentLogin()">Open Dashboard</button>
    </div>

    <div id="admin-login" class="screen card">
        <h2>Admin Authentication</h2>
        <input type="password" id="admin-key" placeholder="Enter Administrator Access Code">
        <button class="btn btn-admin" onclick="handleAdminLogin()">Verify & Login</button>
    </div>

    <div id="admin-panel" class="screen">
        <div class="card">
            <h2 style="color:var(--primary)">New Student Enrollment</h2>
            <div class="form-grid">
                <div>
                    <label>Full Name</label>
                    <input type="text" id="reg-name" placeholder="Firstname Lastname">
                </div>
                <div>
                    <label>Admission Number</label>
                    <input type="text" id="reg-id" placeholder="GAIC/2025/xxx">
                </div>
                <div>
                    <label>Class Category</label>
                    <select id="reg-category" onchange="calculateFees()">
                        <option value="JSS">Junior Secondary (JSS 1-3)</option>
                        <option value="SSS_SCIENCE">Senior Secondary (Science)</option>
                        <option value="SSS_ART">Senior Secondary (Art & Commerce)</option>
                    </select>
                </div>
                <div>
                    <label>Specific Class</label>
                    <select id="reg-class">
                        <option>JSS 1</option><option>JSS 2</option><option>JSS 3</option>
                        <option>SSS 1</option><option>SSS 2</option><option>SSS 3</option>
                    </select>
                </div>
                <div>
                    <label>Entry Session</label>
                    <input type="text" id="reg-session" value="2025/2026">
                </div>
                <div>
                    <label>Assigned Fees</label>
                    <input type="text" id="reg-fee-display" value="â‚¦50,000" disabled>
                </div>
            </div>
            <button class="btn" onclick="saveStudent()">Register & Generate Profile</button>
        </div>

        <div class="card">
            <h3>Registered Student Records</h3>
            <div class="table-wrap">
                <table id="record-table">
                    <thead>
                        <tr>
                            <th>Student Name</th>
                            <th>Adm Number</th>
                            <th>Class</th>
                            <th>Session</th>
                            <th>Fees</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="admin-list-body">
                        </tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="student-dash" class="screen">
        <div class="card" style="border-left: 8px solid var(--accent); background: var(--secondary); color: white;">
            <h2>Student Profile</h2>
            <div class="form-grid">
                <p>Name: <span id="s-name" style="color:var(--accent); font-weight:bold;">...</span></p>
                <p>ID: <span id="s-id">...</span></p>
                <p>Class: <span id="s-class">...</span></p>
                <p>Session: <span id="s-session">...</span></p>
            </div>
        </div>

        <div class="card">
            <h3>ðŸ’³ Financial Statement</h3>
            <p>Your current tuition for this term is <strong id="s-fee-amt">â‚¦0.00</strong></p>
            <div id="s-status" class="badge unpaid">PENDING PAYMENT</div>
            <br><br>
            <button id="pay-button" class="btn btn-pay" onclick="payWithFlutterwave()">Secure Payment via Flutterwave</button>
        </div>
    </div>

</div>

<script>
    // --- SCHOOL DATABASE (LOCAL FOR TESTING) ---
    // Note: To make this permanent, connect Firebase Firestore
    let students = [];
    let loggedInStudent = null;

    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    // Admin Access Code
    function handleAdminLogin() {
        if(document.getElementById('admin-key').value === "admin777") {
            showScreen('admin-panel');
        } else { alert("Unauthorized Access!"); }
    }

    // Enrollment Logic
    function calculateFees() {
        const cat = document.getElementById('reg-category').value;
        const feeInput = document.getElementById('reg-fee-display');
        if(cat === "JSS") feeInput.value = "â‚¦50,000";
        else if(cat === "SSS_SCIENCE") feeInput.value = "â‚¦80,000";
        else feeInput.value = "â‚¦70,000";
    }

    function saveStudent() {
        const name = document.getElementById('reg-name').value;
        const id = document.getElementById('reg-id').value;
        const cls = document.getElementById('reg-class').value;
        const cat = document.getElementById('reg-category').value;
        const session = document.getElementById('reg-session').value;
        
        let fee = (cat === "JSS") ? 50000 : (cat === "SSS_SCIENCE" ? 80000 : 70000);

        if(!name || !id) return alert("Please fill all details");

        const student = { name, id, cls, session, fee, status: "Unpaid" };
        students.push(student);
        updateAdminTable();
        alert("Student Enrollment Successful!");
    }

    function updateAdminTable() {
        const body = document.getElementById('admin-list-body');
        body.innerHTML = "";
        students.forEach(s => {
            body.innerHTML += `<tr>
                <td>${s.name}</td>
                <td>${s.id}</td>
                <td>${s.cls}</td>
                <td>${s.session}</td>
                <td>â‚¦${s.fee.toLocaleString()}</td>
                <td><span class="badge ${s.status.toLowerCase()}">${s.status}</span></td>
            </tr>`;
        });
    }

    // Student Portal Logic
    function handleStudentLogin() {
        const id = document.getElementById('login-id').value;
        const found = students.find(s => s.id === id);

        if(found) {
            loggedInStudent = found;
            document.getElementById('s-name').innerText = found.name;
            document.getElementById('s-id').innerText = found.id;
            document.getElementById('s-class').innerText = found.cls;
            document.getElementById('s-session').innerText = found.session;
            document.getElementById('s-fee-amt').innerText = "â‚¦" + found.fee.toLocaleString();
            
            // Toggle Pay button based on status
            if(found.status === "Paid") {
                document.getElementById('s-status').className = "badge paid";
                document.getElementById('s-status').innerText = "PAID - RECORD UPDATED";
                document.getElementById('pay-button').style.display = "none";
            }
            showScreen('student-dash');
        } else {
            alert("Record not found. Ensure you have been registered by the Admin.");
        }
    }

    // Flutterwave Integration
    function payWithFlutterwave() {
        FlutterwaveCheckout({
          public_key: "FLWPUBK_TEST-YOUR-KEY-HERE",
          tx_ref: "GAIC-" + loggedInStudent.id + "-" + Date.now(),
          amount: loggedInStudent.fee,
          currency: "NGN",
          customer: {
            email: "student@greatachiever.com",
            name: loggedInStudent.name,
          },
          callback: function (data) {
            if (data.status === "successful") {
                loggedInStudent.status = "Paid";
                updateAdminTable();
                handleStudentLogin(); // Refresh dashboard
                alert("Payment Confirmed! Receipt Generated.");
            }
          }
        });
    }
</script>

</body>
</html>
