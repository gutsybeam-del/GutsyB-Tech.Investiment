<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Great Achiever Portal | Premium</title>
    <script src="https://checkout.flutterwave.com/v3.js"></script>
    <style>
        :root { --primary: #800000; --navy: #001f3f; --gold: #daa520; --bg: #f0f2f5; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); margin: 0; display: flex; flex-direction: column; height: 100vh; }
        
        /* Top Navigation Bar */
        .top-nav { background: var(--primary); color: white; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 4px solid var(--gold); }
        .logo-area { font-weight: 800; font-size: 20px; }

        /* Main Layout */
        .main-wrapper { display: flex; flex: 1; overflow: hidden; }

        /* Sidebar Menu */
        .sidebar { width: 250px; background: var(--navy); color: white; display: flex; flex-direction: column; padding: 20px 0; }
        .sidebar a { padding: 15px 25px; color: #cbd5e1; text-decoration: none; display: block; cursor: pointer; border-left: 4px solid transparent; }
        .sidebar a:hover, .sidebar a.active-link { background: #1e293b; color: white; border-left-color: var(--gold); }

        /* Content Area */
        .content { flex: 1; padding: 30px; overflow-y: auto; }
        .card { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); margin-bottom: 25px; }
        .screen { display: none; }
        .active-screen { display: block; animation: fadeIn 0.3s ease; }

        /* Profile Section */
        .profile-img { width: 100px; height: 100px; border-radius: 50%; border: 3px solid var(--gold); object-fit: cover; margin-bottom: 15px; }
        
        /* Forms & Buttons */
        input, select { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; }
        .btn { padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; width: 100%; }
        .btn-pay { background: var(--gold); color: black; }
        .btn-save { background: var(--primary); color: white; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @media (max-width: 768px) { .sidebar { display: none; } .main-wrapper { flex-direction: column; } }
    </style>
</head>
<body>

    <div class="top-nav">
        <div class="logo-area">GREAT ACHIEVER PORTAL</div>
        <div id="user-tag" style="font-size: 14px;">Guest</div>
    </div>

    <div class="main-wrapper">
        <div class="sidebar" id="main-sidebar" style="display: none;">
            <a onclick="showScreen('s-home')" id="link-home">üè† Home Dashboard</a>
            <a onclick="showScreen('s-results')" id="link-results">üìä View Results</a>
            <a onclick="showScreen('s-fees')" id="link-fees">üí≥ School Fees</a>
            <a onclick="showScreen('s-profile')" id="link-profile">üë§ My Profile</a>
            <a onclick="logout()" style="color: #ff4444; margin-top: auto;">Logout</a>
        </div>

        <div class="content">
            <div id="login-screen" class="screen active-screen card" style="max-width: 400px; margin: 50px auto;">
                <h2 style="text-align: center; color: var(--primary);">Login</h2>
                <input type="text" id="login-id" placeholder="Admission Number">
                <input type="password" id="login-pass" placeholder="Password">
                <button class="btn btn-save" onclick="handleLogin()">Login to Portal</button>
                <p style="text-align: center; margin-top: 20px; font-size: 13px; color: #666;" onclick="showAdminLogin()">Staff Access Only</p>
            </div>

            <div id="admin-screen" class="screen card">
                <h2>Admin Management</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <h3>Enroll Student</h3>
                        <input type="text" id="reg-name" placeholder="Full Name">
                        <input type="text" id="reg-id" placeholder="Admission ID">
                        <input type="text" id="reg-pass" placeholder="Password" value="1234">
                        <button class="btn btn-save" onclick="register()">Register Student</button>
                    </div>
                    <div>
                        <h3>Upload Results</h3>
                        <select id="res-select"><option>Select Student</option></select>
                        <input type="number" id="res-math" placeholder="Maths Score">
                        <input type="number" id="res-eng" placeholder="English Score">
                        <button class="btn btn-save" onclick="saveResult()">Save Scores</button>
                    </div>
                </div>
                <hr>
                <div id="admin-list"></div>
            </div>

            <div id="s-home" class="screen">
                <div class="card" style="display: flex; align-items: center; gap: 20px; background: linear-gradient(to right, var(--navy), #1e293b); color: white;">
                    <img src="https://via.placeholder.com/100" class="profile-img" id="display-img">
                    <div>
                        <h2 id="display-name">...</h2>
                        <p id="display-class">Admission No: ...</p>
                    </div>
                </div>
                <div class="card">
                    <h3>School Announcements</h3>
                    <p>üì¢ First Term exams begin on the 15th of Jan. Ensure all fees are cleared.</p>
                </div>
            </div>

            <div id="s-results" class="screen card">
                <h3>Academic Report Card</h3>
                <table width="100%" border="1" cellpadding="10" style="border-collapse: collapse;">
                    <tr style="background: #f8f9fa;"><th>Subject</th><th>Score</th><th>Grade</th></tr>
                    <tr><td>Mathematics</td><td id="m-score">-</td><td id="m-grade">-</td></tr>
                    <tr><td>English Language</td><td id="e-score">-</td><td id="e-grade">-</td></tr>
                </table>
            </div>

            <div id="s-fees" class="screen card">
                <h3>Financial Status</h3>
                <p>Tuition Balance: <strong id="fee-bal">‚Ç¶0.00</strong></p>
                <div id="fee-badge" style="padding: 10px; display: inline-block; border-radius: 5px;"></div><br><br>
                <button class="btn btn-pay" id="pay-btn" onclick="payNow()">Pay with Flutterwave</button>
            </div>

            <div id="s-profile" class="screen card">
                <div id="s-profile" class="screen card">
    <h3>User Profile & Photo</h3>
    <div style="text-align: center;">
        <img src="https://via.placeholder.com/100" id="profile-preview" class="profile-img">
    </div>
    
    <label>Student Photo Link (URL)</label>
    <input type="text" id="new-img" placeholder="Paste image link here (e.g., https://site.com/photo.jpg)">
    <p style="font-size: 12px; color: #666;">Tip: Upload photo to PostImages.org and paste the 'Direct Link' here.</p>
    
    <button class="btn btn-save" onclick="updateProfile()">Save Profile Photo</button>
    <hr>
    
    <label>Change Security Password</label>
    <input type="password" id="new-pass" placeholder="Enter New Password">
    <button class="btn btn-save" style="background: var(--navy);" onclick="changePass()">Update Password</button>
</div>
            </div>
        </div>
    </div>

    <script>
        let students = JSON.parse(localStorage.getItem('GAIC_DATA')) || [];
        let loggedUser = null;

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen'));
            document.getElementById(id).classList.add('active-screen');
            // Update link styling
            document.querySelectorAll('.sidebar a').forEach(a => a.classList.remove('active-link'));
            if(document.getElementById('link-' + id.split('-')[1])) {
                document.getElementById('link-' + id.split('-')[1]).classList.add('active-link');
            }
        }

        function handleLogin() {
            const id = document.getElementById('login-id').value;
            const pass = document.getElementById('login-pass').value;
            const user = students.find(s => s.id === id && s.pass === pass);

            if(user) {
                loggedUser = user;
                document.getElementById('main-sidebar').style.display = 'flex';
                document.getElementById('user-tag').innerText = user.name;
                loadStudentData();
                showScreen('s-home');
            } else { alert("Invalid Credentials"); }
        }

        function loadStudentData() {
            document.getElementById('display-name').innerText = loggedUser.name;
            document.getElementById('display-class').innerText = "ID: " + loggedUser.id;
            document.getElementById('display-img').src = loggedUser.pic || "https://via.placeholder.com/100";
            document.getElementById('m-score').innerText = loggedUser.math || '-';
            document.getElementById('e-score').innerText = loggedUser.eng || '-';
            document.getElementById('fee-bal').innerText = "‚Ç¶" + (loggedUser.paid ? "0.00" : "50,000");
            
            const badge = document.getElementById('fee-badge');
            badge.innerText = loggedUser.paid ? "PAID" : "UNPAID";
            badge.style.background = loggedUser.paid ? "#d4edda" : "#f8d7da";
            document.getElementById('pay-btn').style.display = loggedUser.paid ? 'none' : 'block';
        }

        function updateProfile() {
            function updateProfile() {
    const imgUrl = document.getElementById('new-img').value;
    
    if (imgUrl.includes("http")) {
        loggedUser.pic = imgUrl; // Update the student's data
        document.getElementById('display-img').src = imgUrl; // Update dashboard icon
        document.getElementById('profile-preview').src = imgUrl; // Update preview
        
        // Save to permanent memory
        localStorage.setItem('GAIC_DATA', JSON.stringify(students));
        alert("Profile picture updated successfully!");
    } else {
        alert("Please enter a valid web link (URL) for the image.");
    }
}
        }

        function changePass() {
            loggedUser.pass = document.getElementById('new-pass').value;
            localStorage.setItem('GAIC_DATA', JSON.stringify(students));
            alert("Password Changed!");
        }

        function logout() { location.reload(); }

        // --- ADMIN FUNCTIONS ---
        function showAdminLogin() { 
            const p = prompt("Enter Admin Key:");
            if(p === "777") {
                updateAdminList();
                showScreen('admin-screen');
                document.getElementById('main-sidebar').style.display = 'none';
            }
        }

        function register() {
            const name = document.getElementById('reg-name').value;
            const id = document.getElementById('reg-id').value;
            const pass = document.getElementById('reg-pass').value;
            students.push({ name, id, pass, paid: false, math: '-', eng: '-', pic: '' });
            localStorage.setItem('GAIC_DATA', JSON.stringify(students));
            updateAdminList();
            alert("Registered!");
        }

        function updateAdminList() {
            const sel = document.getElementById('res-select');
            sel.innerHTML = "<option>Select Student</option>";
            students.forEach(s => {
                sel.innerHTML += `<option value="${s.id}">${s.name}</option>`;
            });
        }

        function saveResult() {
            const id = document.getElementById('res-select').value;
            const user = students.find(s => s.id === id);
            user.math = document.getElementById('res-math').value;
            user.eng = document.getElementById('res-eng').value;
            localStorage.setItem('GAIC_DATA', JSON.stringify(students));
            alert("Results Saved!");
        }

        function payNow() {
            FlutterwaveCheckout({
                public_key: "FLWPUBK_TEST-YOUR-KEY",
                tx_ref: "GAIC-" + Date.now(),
                amount: 50000,
                currency: "NGN",
                customer: { email: "student@school.com", name: loggedUser.name },
                callback: function (data) {
                    if (data.status === "successful") {
                        loggedUser.paid = true;
                        localStorage.setItem('GAIC_DATA', JSON.stringify(students));
                        loadStudentData();
                        alert("Fees Paid Successfully!");
                    }
                }
            });
        }
    </script>
</body>
</html>

