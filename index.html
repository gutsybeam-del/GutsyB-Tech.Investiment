<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal | Great Achiever International College</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://checkout.flutterwave.com/v3.js"></script>
    
    <style>
        :root { --maroon: #800000; --gold: #daa520; --navy: #000080; --light: #f4f4f4; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--light); margin: 0; }
        
        /* Header & Branding */
        header { background: var(--maroon); color: white; padding: 20px; text-align: center; border-bottom: 5px solid var(--gold); }
        .logo-text { font-size: 28px; font-weight: bold; letter-spacing: 2px; }
        
        /* Navigation */
        nav { background: var(--navy); padding: 10px; display: flex; justify-content: center; gap: 20px; }
        nav a { color: white; text-decoration: none; font-weight: bold; cursor: pointer; }

        /* Portal Logic Styles */
        .container { max-width: 1000px; margin: 30px auto; padding: 20px; }
        .card { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); margin-bottom: 20px; border-top: 4px solid var(--maroon); }
        .screen { display: none; }
        .active { display: block; }

        /* UI Elements */
        .btn { padding: 12px 25px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; width: 100%; font-size: 16px; margin-top: 10px; }
        .btn-pay { background: var(--gold); color: black; }
        .btn-login { background: var(--navy); color: white; }
        input, select { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background: var(--maroon); color: white; }
        .status-paid { color: green; font-weight: bold; }
        .status-debt { color: red; font-weight: bold; }
    </style>
</head>
<body>

<header>
    <div class="logo-text">GREAT ACHIEVER INTERNATIONAL COLLEGE</div>
    <p>Knowledge, Excellence, and Integrity</p>
</header>

<nav>
    <a onclick="showScreen('login-screen')">Login</a>
    <a onclick="showScreen('result-screen')">Check Result</a>
    <a onclick="showScreen('fees-screen')">Pay Fees</a>
</nav>

<div class="container">

    <div id="login-screen" class="screen active card">
        <h2 style="color: var(--maroon);">Student Portal Login</h2>
        <p>Enter your Matric/Admission Number to access your dashboard.</p>
        <input type="text" id="matric-no" placeholder="Matric Number (e.g. GAIC/2025/001)">
        <select id="student-level">
            <option value="JSS">Junior Secondary (JSS 1-3)</option>
            <option value="SSS_SCIENCE">Senior Secondary (Science)</option>
            <option value="SSS_ART">Senior Secondary (Art & Commerce)</option>
        </select>
        <button class="btn btn-login" onclick="loginPortal()">Access Portal</button>
    </div>

    <div id="dash-screen" class="screen">
        <div class="card">
            <h2>Welcome, <span id="display-name">Student</span></h2>
            <p>Class: <span id="display-class">...</span></p>
        </div>

        <div id="result-screen" class="card">
            <h3>ðŸ“Š Academic Statement (Termly Result)</h3>
            <table>
                <thead>
                    <tr><th>Subject</th><th>Test (40)</th><th>Exam (60)</th><th>Total</th><th>Grade</th></tr>
                </thead>
                <tbody id="result-body">
                    <tr><td>Mathematics</td><td>32</td><td>55</td><td>87</td><td>A1</td></tr>
                    <tr><td>English</td><td>28</td><td>42</td><td>70</td><td>B2</td></tr>
                </tbody>
            </table>
        </div>

        <div id="fees-screen" class="card">
            <h3>ðŸ’³ School Fees Payment</h3>
            <div style="font-size: 18px; margin-bottom: 10px;">
                Required Fee: <span id="fee-amount" style="font-weight:bold;">â‚¦0.00</span><br>
                Status: <span id="fee-status" class="status-debt">UNPAID</span>
            </div>
            <button class="btn btn-pay" onclick="processPayment()">Pay Outstanding Balance</button>
        </div>
    </div>

</div>

<script>
    // --- BACKEND CONFIGURATION ---
    // Initialize Firebase (Paste your real keys here to make it save data)
    const firebaseConfig = {
        apiKey: "YOUR_API_KEY",
        authDomain: "great-achiever-portal.firebaseapp.com",
        projectId: "great-achiever-portal",
        appId: "YOUR_APP_ID"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Portal Logic
    let currentUser = {
        matric: "",
        level: "",
        fee: 0
    };

    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        // If they click "Check Result" or "Fees" before logging in, send them back
        if(id !== 'login-screen' && currentUser.matric === "") {
            alert("Please login first!");
            showScreen('login-screen');
        }
    }

    function loginPortal() {
        const matric = document.getElementById('matric-no').value;
        const level = document.getElementById('student-level').value;

        if(!matric) return alert("Enter your Matric Number");

        currentUser.matric = matric;
        currentUser.level = level;

        // Set Fees based on your requirements
        if(level === "JSS") currentUser.fee = 50000;
        else if(level === "SSS_SCIENCE") currentUser.fee = 80000;
        else if(level === "SSS_ART") currentUser.fee = 70000;

        // Update UI
        document.getElementById('display-name').innerText = matric;
        document.getElementById('display-class').innerText = level.replace("_", " ");
        document.getElementById('fee-amount').innerText = "â‚¦" + currentUser.fee.toLocaleString();
        
        showScreen('dash-screen');
    }

    // --- PAYMENT BACKEND (FLUTTERWAVE) ---
    function processPayment() {
        FlutterwaveCheckout({
            public_key: "FLWPUBK_TEST-YOUR-KEY-HERE", // Change to Live Key later
            tx_ref: "GAIC-" + currentUser.matric + "-" + Date.now(),
            amount: currentUser.fee,
            currency: "NGN",
            payment_options: "card, banktransfer, ussd",
            customer: {
                email: "student@greatachiever.com",
                name: currentUser.matric,
            },
            callback: function (data) {
                if (data.status === "successful") {
                    document.getElementById('fee-status').innerText = "PAID";
                    document.getElementById('fee-status').className = "status-paid";
                    alert("Payment Verified! Thank you.");
                    
                    // Save to Backend (Firebase)
                    db.collection("payments").doc(currentUser.matric).set({
                        amount: currentUser.fee,
                        status: "Paid",
                        date: new Date()
                    });
                }
            },
            customizations: {
                title: "Great Achiever College",
                description: "School Fees Payment for " + currentUser.level,
                logo: "https://via.placeholder.com/150",
            },
        });
    }
</script>
</body>
</html>
