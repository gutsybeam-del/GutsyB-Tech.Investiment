<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Great Achiever International College | Remita Payment Portal</title>
    <script src="https://remitademo.net/payment/v1/remita-pay-inline.bundle.js"></script>
    <style>
        :root { --primary: #800000; --navy: #001f3f; --gold: #daa520; --light: #f4f7f6; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--light); margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        header { background: var(--primary); color: white; padding: 15px 25px; display: flex; justify-content: space-between; align-items: center; border-bottom: 4px solid var(--gold); }
        .main-container { display: flex; flex: 1; overflow: hidden; }
        
        .sidebar { width: 280px; background: var(--navy); color: white; display: none; flex-direction: column; padding-top: 20px; box-shadow: 2px 0 10px rgba(0,0,0,0.1); }
        .sidebar a { padding: 15px 25px; color: #cbd5e1; text-decoration: none; display: block; cursor: pointer; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .sidebar a:hover { background: rgba(255,255,255,0.1); color: var(--gold); }

        .content { flex: 1; padding: 25px; overflow-y: auto; }
        .card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 25px; }
        .screen { display: none; }
        .active-screen { display: block; animation: fadeIn 0.3s ease; }

        .profile-img { width: 120px; height: 120px; border-radius: 50%; border: 3px solid var(--gold); object-fit: cover; display: block; margin: 10px auto; background: #eee; }
        input, select { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }
        
        .btn { padding: 14px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; width: 100%; margin-top: 10px; }
        .btn-main { background: var(--primary); color: white; }
        .btn-remita { background: #ff5722; color: white; display: flex; align-items: center; justify-content: center; gap: 10px; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { border: 1px solid #eee; padding: 12px; text-align: left; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<header>
    <div style="font-weight: 900; letter-spacing: 1px; font-size: 18px;">GREAT ACHIEVER INTERNATIONAL COLLEGE</div>
    <div id="status-tag" style="font-size: 11px;">REMITA SECURE</div>
</header>

<div class="main-container">
    <div class="sidebar" id="sidebar">
        <a onclick="showScreen('s-home')">üè† Dashboard Home</a>
        <a onclick="showScreen('s-reg')">üìù Course Registration</a>
        <a onclick="showScreen('s-fees')">üí≥ Pay School Fees</a>
        <a onclick="showScreen('s-results')">üìä Exam Results</a>
        <a onclick="showScreen('s-settings')">‚öôÔ∏è Profile Settings</a>
        <a onclick="location.reload()" style="color:#ff6b6b;">Logout</a>
    </div>

    <div class="content">
        <div id="login-screen" class="screen active-screen card" style="max-width: 420px; margin: 40px auto;">
            <h2 style="text-align:center; color:var(--primary);">Student Login</h2>
            <input type="text" id="l-id" placeholder="Admission Number">
            <input type="password" id="l-pass" placeholder="Password">
            <button class="btn btn-main" onclick="doLogin()">Access Portal</button>
            <p onclick="adminGate()" style="text-align:center; cursor:pointer; font-size:11px; margin-top:20px; color:gray;">Staff Admin Entry</p>
        </div>

        <div id="admin-screen" class="screen card">
            <button class="btn" style="width:auto; background:#666; color:white;" onclick="showScreen('login-screen')">‚¨Ö Back</button>
            <h2>Admin Office</h2>
            <input type="text" id="r-name" placeholder="Full Name">
            <input type="text" id="r-id" placeholder="Admission Number">
            <select id="r-dept">
                <option value="JSS">JSS (‚Ç¶55,000)</option>
                <option value="Science">Science (‚Ç¶85,000)</option>
                <option value="Art">Art (‚Ç¶75,000)</option>
                <option value="Commerce">Commerce (‚Ç¶75,000)</option>
            </select>
            <button class="btn btn-main" onclick="enroll()">Register Student</button>
        </div>

        <div id="s-fees" class="screen card">
            <h2>School Fees Payment</h2>
            <div style="background:#f0f7ff; padding:20px; border-radius:10px; border:1px solid #007bff;">
                <p>Outstanding Balance: <strong id="f-amt">‚Ç¶0.00</strong></p>
                <p>Status: <span id="f-stat" style="font-weight:bold;">PENDING</span></p>
            </div>
            <br>
            <p style="font-size:13px; color:#555;">Click the button below to generate your Remita RRR and pay online or at any bank branch.</p>
            <button class="btn btn-remita" id="remita-btn" onclick="makeRemitaPayment()">
                <img src="https://www.remita.net/assets/img/remita-logo.png" alt="Remita" height="20"> 
                Pay with Remita
            </button>
        </div>

        <div id="s-home" class="screen card" style="text-align:center;">
            <img src="" id="h-img" class="profile-img">
            <h2 id="h-name">Student Name</h2>
            <p id="h-dept" style="color:var(--gold); font-weight:bold;">DEPARTMENT</p>
            <div style="background:#e8f5e9; padding:20px; border-radius:12px; margin-top:20px;">
                <h4>Welcome to Great Achiever</h4>
                <p>Pay your fees to unlock your examination results.</p>
            </div>
        </div>

        <div id="s-reg" class="screen card">
            <h2>Course Registration</h2>
            <div id="subject-list" style="display:grid; grid-template-columns:1fr 1fr; gap:10px;"></div>
            <button class="btn btn-main" onclick="saveCourses()">Save Registration</button>
        </div>

        <div id="s-results" class="screen card">
            <h2>Examination Results</h2>
            <div id="res-display">Please pay fees to view results.</div>
        </div>

        <div id="s-settings" class="screen card">
            <h3>Account Settings</h3>
            <input type="file" id="file-input" accept="image/*" onchange="previewImg()">
            <button class="btn btn-main" onclick="savePhoto()">Update Passport</button>
            <hr>
            <input type="password" id="new-p" placeholder="Change Password">
            <button class="btn btn-main" onclick="savePass()">Update Password</button>
        </div>
    </div>
</div>

<script>
    let db = JSON.parse(localStorage.getItem('GREAT_ACHIEVER_DB')) || [];
    let user = null;
    let tempImg = "";

    const feeSchedule = { "JSS": 55000, "Science": 85000, "Art": 75000, "Commerce": 75000 };
    const officialSubjects = {
        "JSS": ["Mathematics", "English Studies", "Basic Science", "Social Studies", "Basic Tech"],
        "Science": ["Physics", "Chemistry", "Biology", "Further Maths", "General Maths", "English"],
        "Art": ["Government", "Literature", "History", "CRS/IRS", "General Maths", "English"],
        "Commerce": ["Accounts", "Commerce", "Economics", "Marketing", "General Maths", "English"]
    };

    function showScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen'));
        document.getElementById(id).classList.add('active-screen');
        if(id === 's-reg') loadSubjects();
        if(id === 's-results') loadResults();
    }

    function doLogin() {
        const id = document.getElementById('l-id').value;
        const pass = document.getElementById('l-pass').value;
        user = db.find(x => x.id === id && x.pass === pass);
        if(user) {
            document.getElementById('sidebar').style.display = 'flex';
            refreshHome();
            showScreen('s-home');
        } else { alert("Login Error"); }
    }

    function refreshHome() {
        document.getElementById('h-name').innerText = user.name;
        document.getElementById('h-dept').innerText = user.dept.toUpperCase();
        document.getElementById('h-img').src = user.img || "https://via.placeholder.com/120";
        document.getElementById('f-amt').innerText = "‚Ç¶" + feeSchedule[user.dept].toLocaleString();
        document.getElementById('f-stat').innerText = user.paid ? "PAID ‚úÖ" : "UNPAID ‚ùå";
        document.getElementById('remita-btn').style.display = user.paid ? 'none' : 'flex';
    }

    function makeRemitaPayment() {
        // This is a Demo Integration. For Live, you need a Merchant ID and Service Type ID.
        var paymentEngine = RmPaymentEngine.init({
            key: "REVXU0VSfDQwMjc1fGYzY2M0Y2VlYTNkM2IyZTM5YTZlMGRhNmU3YmU5YWVl", // Demo Key
            processRrr: true,
            transactionId: "GAIC-" + Math.floor(Math.random() * 1101233),
            firstName: user.name,
            lastName: "Student",
            email: user.id + "@school.com",
            amount: feeSchedule[user.dept],
            customerId: user.id,
            description: "School Fees Payment for Great Achiever International College",
            onSuccess: function (response) {
                user.paid = true;
                localStorage.setItem('GREAT_ACHIEVER_DB', JSON.stringify(db));
                refreshHome();
                alert("Payment Successful! RRR: " + response.rrr);
            },
            onError: function (response) {
                alert("Payment Failed: " + response.message);
            }
        });
        paymentEngine.showPaymentWidget();
    }

    function enroll() {
        const name = document.getElementById('r-name').value;
        const id = document.getElementById('r-id').value;
        const dept = document.getElementById('r-dept').value;
        db.push({ name, id, dept, pass: "1234", img: "", paid: false, registered: [] });
        localStorage.setItem('GREAT_ACHIEVER_DB', JSON.stringify(db));
        alert("Student Registered!");
    }

    function loadSubjects() {
        const box = document.getElementById('subject-list');
        box.innerHTML = "";
        officialSubjects[user.dept].forEach(sub => {
            box.innerHTML += `<div><input type="checkbox" value="${sub}"> <label>${sub}</label></div>`;
        });
    }

    function loadResults() {
        const box = document.getElementById('res-display');
        if(!user.paid) {
            box.innerHTML = "<h3 style='color:red;'>Access Denied: Please pay your fees via Remita to unlock results.</h3>";
        } else {
            box.innerHTML = "<h3>Results Unlocked. Scores will be uploaded by Staff soon.</h3>";
        }
    }

    function adminGate() { if(prompt("Admin Key:") === "777") showScreen('admin-screen'); }
</script>
</body>
</html>
